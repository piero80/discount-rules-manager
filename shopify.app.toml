# Learn more about configuring your app at https://shopify.dev/docs/apps/tools/cli/configuration

client_id = "413ee41460b0764b68a32fb63ec9ac78"
name = "Smart Discount Rules Manager"
application_url = "https://discount-rules-manager-production.up.railway.app"
embedded = true

[build]
automatically_update_urls_on_dev = true

[webhooks]
api_version = "2026-01"

  [[webhooks.subscriptions]]
  topics = [ "app/uninstalled" ]
  uri = "/webhooks/app/uninstalled"

  [[webhooks.subscriptions]]
  topics = [ "app/scopes_update" ]
  uri = "/webhooks/app/scopes_update"

[access_scopes]
# Learn more at https://shopify.dev/docs/apps/tools/cli/configuration#access_scopes
scopes = "read_discounts,read_price_rules,read_products,write_discounts,write_price_rules"

[auth]
redirect_urls = [
  "https://discount-rules-manager-production.up.railway.app/auth/callback",
  "https://discount-rules-manager-production.up.railway.app/auth/shopify/callback"
]

# GDPR Compliance Webhooks (OBBLIGATORI)
# Questi 3 webhook DEVONO essere configurati per passare la review Shopify

# 1. Customer data request (GDPR Art. 15 - Right to access)
[webhooks.privacy_compliance.customer_data_request]
path = "/webhooks/gdpr"

# 2. Customer redact (GDPR Art. 17 - Right to erasure)
[webhooks.privacy_compliance.customer_redaction]
path = "/webhooks/gdpr"

# 3. Shop redact (Triggered 48h after uninstall)
[webhooks.privacy_compliance.shop_redaction]
path = "/webhooks/gdpr"

# Webhook opzionali per features (aggiungi dopo che GDPR funziona)
# [[webhooks.subscriptions]]
# topics = ["discounts/create", "discounts/update"]
# uri = "/webhooks"

# [[webhooks.subscriptions]]
# topics = ["collections/create"]
# uri = "/webhooks"

[pos]
embedded = false